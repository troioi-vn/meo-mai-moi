#!/usr/bin/env php
<?php

use Illuminate\Foundation\Application;
use Symfony\Component\Console\Input\ArgvInput;

define('LARAVEL_START', microtime(true));

// NOTE:
// Do not auto-create .env during non-interactive runs (e.g. Docker build/deploy).
// If you want the old behavior locally, set LARAVEL_CREATE_ENV_FROM_EXAMPLE=1.
$envPath = __DIR__.'/.env';
$envExample = __DIR__.'/.env.example';

if (
    getenv('LARAVEL_CREATE_ENV_FROM_EXAMPLE') === '1'
    && !file_exists($envPath)
    && file_exists($envExample)
) {
    if (!copy($envExample, $envPath)) {
        fwrite(STDERR, "Failed to create .env file. Please copy .env.example to .env manually.\n");
        exit(1);
    }
}

// Register the Composer autoloader...
require __DIR__.'/vendor/autoload.php';

// Bootstrap Laravel and handle the command...
/** @var Application $app */
$app = require_once __DIR__.'/bootstrap/app.php';

$status = $app->handleCommand(new ArgvInput);

exit($status);
